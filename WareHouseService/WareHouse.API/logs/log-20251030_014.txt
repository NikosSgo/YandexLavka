2025-10-30 22:09:47.687 +03:00 [INF] Kafka consumer configured for topics: orders, warehouse-commands, warehouse-events, picking-tasks, stock-updates
2025-10-30 22:09:47.756 +03:00 [INF] Starting Kafka consumer for topics: orders, warehouse-commands, warehouse-events, picking-tasks, stock-updates
2025-10-30 22:09:47.762 +03:00 [INF] Waiting 10 seconds for Kafka to be ready...
2025-10-30 22:10:00.820 +03:00 [INF] Incoming request: GET /api/Stock/low-stock
2025-10-30 22:10:00.918 +03:00 [INF] Getting low stock items
2025-10-30 22:10:00.952 +03:00 [INF] Handling command/query: GetLowStockQuery {"$type":"GetLowStockQuery"}
2025-10-30 22:10:00.989 +03:00 [INF] Getting low stock items
2025-10-30 22:10:01.139 +03:00 [INF] Found 1 low stock items
2025-10-30 22:10:01.151 +03:00 [INF] Handled command/query: GetLowStockQuery
2025-10-30 22:10:01.189 +03:00 [INF] Request completed: GET /api/Stock/low-stock - 200 in 373.6729ms
2025-10-30 22:21:39.993 +03:00 [INF] Incoming request: PUT /api/Stock/products/3f9bcc41-4a35-496b-a008-30428253ecb4/stock
2025-10-30 22:21:40.053 +03:00 [INF] Updating stock for product "3f9bcc41-4a35-496b-a008-30428253ecb4"
2025-10-30 22:21:40.084 +03:00 [INF] Handling command/query: UpdateStockCommand {"ProductId":"3f9bcc41-4a35-496b-a008-30428253ecb4","Quantity":5,"Location":"EGGS-001","Operation":"adjust","$type":"UpdateStockCommand"}
2025-10-30 22:21:40.164 +03:00 [INF] Updating stock for product "3f9bcc41-4a35-496b-a008-30428253ecb4" at EGGS-001. Operation: adjust
2025-10-30 22:21:40.207 +03:00 [INF] Creating new storage unit for product "3f9bcc41-4a35-496b-a008-30428253ecb4" at EGGS-001
2025-10-30 22:21:40.239 +03:00 [INF] New storage unit created with ID: "00000000-0000-0000-0000-000000000000"
2025-10-30 22:21:40.244 +03:00 [INF] Adjusted stock to 5 units for product "3f9bcc41-4a35-496b-a008-30428253ecb4"
2025-10-30 22:21:40.268 +03:00 [INF] Stock updated successfully for product "3f9bcc41-4a35-496b-a008-30428253ecb4". New quantity: 5
2025-10-30 22:21:40.278 +03:00 [INF] Handled command/query: UpdateStockCommand
2025-10-30 22:21:40.292 +03:00 [INF] Request completed: PUT /api/Stock/products/3f9bcc41-4a35-496b-a008-30428253ecb4/stock - 200 in 298.8404ms
2025-10-30 22:25:11.737 +03:00 [INF] Incoming request: PUT /api/Stock/products/3f9bcc41-4a35-496b-a008-30428253ecb4/stock
2025-10-30 22:25:11.764 +03:00 [INF] Updating stock for product "3f9bcc41-4a35-496b-a008-30428253ecb4"
2025-10-30 22:25:11.776 +03:00 [INF] Handling command/query: UpdateStockCommand {"ProductId":"3f9bcc41-4a35-496b-a008-30428253ecb4","Quantity":5,"Location":"B-02-02","Operation":"adjust","$type":"UpdateStockCommand"}
2025-10-30 22:25:11.821 +03:00 [INF] Updating stock for product "3f9bcc41-4a35-496b-a008-30428253ecb4" at B-02-02. Operation: adjust
2025-10-30 22:25:11.849 +03:00 [INF] Adjusted stock to 5 units for product "3f9bcc41-4a35-496b-a008-30428253ecb4"
2025-10-30 22:25:11.868 +03:00 [INF] Stock updated successfully for product "3f9bcc41-4a35-496b-a008-30428253ecb4". New quantity: 5
2025-10-30 22:25:11.877 +03:00 [INF] Handled command/query: UpdateStockCommand
2025-10-30 22:25:11.884 +03:00 [INF] Request completed: PUT /api/Stock/products/3f9bcc41-4a35-496b-a008-30428253ecb4/stock - 200 in 147.2865ms
2025-10-30 22:43:19.748 +03:00 [INF] Incoming request: GET /api/Orders
2025-10-30 22:43:19.812 +03:00 [INF] Getting orders with status "Picking"
2025-10-30 22:43:19.816 +03:00 [INF] Handling command/query: GetOrdersByStatusQuery {"Status":"\"Picking\"","$type":"GetOrdersByStatusQuery"}
2025-10-30 22:43:19.827 +03:00 [ERR] An unhandled exception has occurred: Invalid order status: "Picking"
WareHouse.Domain.Exceptions.DomainException: Invalid order status: "Picking"
   at WareHouse.Application.Queries.GetOrdersByStatusQueryHandler.Handle(GetOrdersByStatusQuery request, CancellationToken cancellationToken) in C:\Backend_Project\YandexLavka\WareHouseService\WareHouse.Application\Queries\GetOrdersByStatusQuery.cs:line 23
   at WareHouse.Application.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Backend_Project\YandexLavka\WareHouseService\WareHouse.Application\Behaviors\ValidationBehavior.cs:line 36
   at WareHouse.Application.Behaviors.LoggingBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Backend_Project\YandexLavka\WareHouseService\WareHouse.Application\Behaviors\LoggingBehavior.cs:line 22
   at WareHouse.API.Controllers.OrdersController.GetOrdersByStatus(String status) in C:\Backend_Project\YandexLavka\WareHouseService\WareHouse.API\Controllers\OrdersController.cs:line 39
   at lambda_method50(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at WareHouse.API.Middleware.CorrelationIdMiddleware.InvokeAsync(HttpContext context) in C:\Backend_Project\YandexLavka\WareHouseService\WareHouse.API\Middleware\CorrelationIdMiddleware.cs:line 27
   at WareHouse.API.Middleware.RequestLoggingMiddleware.InvokeAsync(HttpContext context) in C:\Backend_Project\YandexLavka\WareHouseService\WareHouse.API\Middleware\RequestLoggingMiddleware.cs:line 23
   at WareHouse.API.Middleware.GlobalExceptionHandlerMiddleware.InvokeAsync(HttpContext context) in C:\Backend_Project\YandexLavka\WareHouseService\WareHouse.API\Middleware\GlobalExceptionHandlerMiddleware.cs:line 27
2025-10-30 22:43:46.029 +03:00 [INF] Incoming request: GET /api/Orders
2025-10-30 22:43:46.042 +03:00 [INF] Getting orders with status Picking
2025-10-30 22:43:46.052 +03:00 [INF] Handling command/query: GetOrdersByStatusQuery {"Status":"Picking","$type":"GetOrdersByStatusQuery"}
2025-10-30 22:43:46.171 +03:00 [INF] Handled command/query: GetOrdersByStatusQuery
2025-10-30 22:43:46.211 +03:00 [INF] Request completed: GET /api/Orders - 200 in 181.298ms
2025-10-30 22:51:19.910 +03:00 [INF] Kafka consumer configured for topics: orders, warehouse-commands, warehouse-events, picking-tasks, stock-updates
2025-10-30 22:51:19.969 +03:00 [INF] Starting Kafka consumer for topics: orders, warehouse-commands, warehouse-events, picking-tasks, stock-updates
2025-10-30 22:51:19.972 +03:00 [INF] Waiting 10 seconds for Kafka to be ready...
2025-10-30 22:51:32.145 +03:00 [INF] Incoming request: GET /api/Health
2025-10-30 22:51:32.196 +03:00 [INF] Health check requested
2025-10-30 22:51:32.216 +03:00 [INF] Request completed: GET /api/Health - 200 in 72.8093ms
2025-10-30 22:51:47.091 +03:00 [INF] Incoming request: GET /api/Health/detailed
2025-10-30 22:51:47.118 +03:00 [INF] Detailed health check requested
2025-10-30 22:51:47.130 +03:00 [INF] Request completed: GET /api/Health/detailed - 200 in 39.6589ms
